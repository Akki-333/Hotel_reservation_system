import{r as a,a as r,j as t,y as b}from"./index-DdFKgk6t.js";const U=()=>{const[m,x]=a.useState([]),[c,p]=a.useState(""),[B,F]=a.useState(!1),[i,j]=a.useState("2-pair"),[d,g]=a.useState(""),[E,_]=a.useState([]),[N,h]=a.useState([]),[v,A]=a.useState(""),[f,o]=a.useState(null),[C,y]=a.useState(""),[T,k]=a.useState(!1);a.useEffect(()=>{u(),w()},[]);const u=()=>{r.get("http://localhost:5000/tables").then(e=>x(e.data)).catch(e=>console.error("Error fetching tables:",e))},w=()=>{r.get("http://localhost:5000/branches").then(e=>_(e.data)).catch(e=>console.error("Error fetching branches:",e))},P=e=>{const s=e.target.value;if(p(s),s.length>0){const l=E.filter(n=>n.id.toString().includes(s)||n.name.toLowerCase().includes(s.toLowerCase()));h(l)}else h([])},I=e=>{p(e),h([])},D=e=>{switch(e){case"2-pair":return 2;case"4-pair":return 4;case"8-pair":return 8;default:return 2}},L=()=>{if(!c||!d){b.warning("Please enter Branch ID and Table Name!");return}const e=D(i),s=Array.from({length:e},(l,n)=>n+1);r.post("http://localhost:5000/tables",{branch_id:c,table_name:d,booked:B,table_type:i,chair_count:e,chairs_list:s,price:v}).then(()=>{u(),g(""),j("2-pair"),b.success("Table created successfully")}).catch(l=>{var S;const n=((S=l.response)==null?void 0:S.data)||"Something went wrong, Please try again";b.error(n),console.error("Error adding table:",l)})},M=e=>{r.delete(`http://localhost:5000/tables/${e}`).then(()=>{x(s=>s.filter(l=>l.id!==e))})},$=e=>{o(e),y(e.table_name),k(!!e.booked)},z=()=>{r.put(`http://localhost:5000/tables/${f.id}`,{table_name:C,booked:T}).then(()=>{u(),o(null)}).catch(e=>console.error("Error updating table:",e))};return t.jsxs("div",{className:"container mt-4",children:[t.jsx("h2",{children:"Table Management"}),t.jsxs("div",{className:"mb-3 position-relative",children:[t.jsx("input",{type:"number",className:"form-control mb-2",placeholder:"Branch ID or Name",value:c,onChange:P}),N.length>0&&t.jsx("ul",{className:"list-group position-absolute w-100",style:{zIndex:10},children:N.map(e=>t.jsxs("li",{className:"list-group-item list-group-item-action",onClick:()=>I(e.id),style:{cursor:"pointer",backgroundColor:"lightgrey",borderColor:"black"},children:[e.name," - ",e.location]},e.id))})]}),t.jsx("input",{type:"text",className:"form-control mb-2",placeholder:"Table Name",value:d,onChange:e=>g(e.target.value)}),t.jsx("input",{type:"text",className:"form-control mb-2",placeholder:"Price of the table",value:v,onChange:e=>A(e.target.value)}),t.jsxs("select",{className:"form-control mb-2",value:i,onChange:e=>j(e.target.value),children:[t.jsx("option",{value:"2-pair",children:"2-Pair Table (2 Chairs)"}),t.jsx("option",{value:"4-pair",children:"4-Pair Table (4 Chairs)"}),t.jsx("option",{value:"8-pair",children:"8-Pair Table (8 Chairs)"})]}),t.jsx("button",{className:"btn btn-primary mt-2",onClick:L,children:"Add Table"}),t.jsx("h4",{style:{padding:8},children:"Available Tables"}),t.jsxs("table",{className:"table table-bordered table-fixed",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"S.No"}),t.jsx("th",{children:"Table Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Chairs"}),t.jsx("th",{children:"Availability"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:m.length>0?m.map((e,s)=>t.jsxs("tr",{children:[t.jsx("td",{children:s+1})," ",t.jsx("td",{children:e.table_name}),t.jsx("td",{children:e.table_type}),t.jsx("td",{children:Array.isArray(e.chairs_list)?e.chairs_list.join(", "):e.chairs_list}),t.jsx("td",{children:e.booked?"Booked":"Available"}),t.jsxs("td",{className:"d-flex gap-2",children:[t.jsx("button",{className:"btn btn-warning btn-sm",onClick:()=>$(e),children:"Edit"}),t.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>M(e.id),children:"Delete"})]})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"text-center",children:"No tables available"})})})]}),f&&t.jsx("div",{className:"modal show d-block",children:t.jsx("div",{className:"modal-dialog",children:t.jsxs("div",{className:"modal-content",children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h5",{className:"modal-title",children:"Edit Table"}),t.jsx("button",{className:"btn-close",onClick:()=>o(null)})]}),t.jsxs("div",{className:"modal-body",children:[t.jsx("input",{type:"text",className:"form-control mb-2",value:C,onChange:e=>y(e.target.value)}),t.jsxs("select",{className:"form-control",value:T,onChange:e=>k(e.target.value==="true"),children:[t.jsx("option",{value:"false",children:"Available"}),t.jsx("option",{value:"true",children:"Booked"})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Cancel"}),t.jsx("button",{className:"btn btn-success",onClick:z,children:"Update"})]})]})})})]})};export{U as default};
